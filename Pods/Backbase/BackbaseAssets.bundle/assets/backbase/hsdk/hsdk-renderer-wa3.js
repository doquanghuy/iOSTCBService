/**
 * Name: hsdk-renderer-wa3
 * Description: HSDK WA3 Renderer is a renderer specifically designed to render HSDK App Shell with an Angular SPA (Single Page Application) based on WA3 (Widget Architecture 3)
 * Version: 1.6.0
 * SHA-1: 1aa22595796fddfb3b3407009ac10e2966011cc8
 */
(function(){"use strict";var makeError=function(componentName){return function(message){return new Error("["+componentName+"] "+message)}};var makeTypeError=function(componentName){return function(message){return new Error("["+componentName+"] "+message)}};var createError=makeError("hsdk-renderer-wa3");var createTypeError=makeTypeError("hsdk-renderer-wa3");var globalContext=typeof global!=="undefined"?global:window;var getHSDKCore=function(){return globalContext["hsdk-core"]||globalContext["mobile-sdk-web"]};var getBBNamespace=function(){return globalContext.BB};var isArray=Array.isArray;var isFunction=function(testValue){return typeof testValue==="function"};var isObject=function(testValue){return testValue!==null&&typeof testValue==="object"&&!isArray(testValue)};var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var isWA3Page=function(page){return Boolean(page.preferences&&page.preferences.native==="BBWebAppRenderer")};var toWA3Item=function(item){return __assign({},item.children?{children:item.children.map((function(child){return toWA3Item(child)}))}:{},{name:item.name,properties:__assign({},item.preferences)})};var getPageModel=function(mbaasPortalModel){return mbaasPortalModel.pages.filter((function(page){return isWA3Page(page)}))[0]};var isPortalModel=function(mbaasModel){return mbaasModel&&mbaasModel.hasOwnProperty("pages")};var toWA3AppModel=function(mbaasPageModel){var appModel=mbaasPageModel.children[0];return{children:appModel.children.map((function(item){return toWA3Item(item)})),name:appModel.name,properties:__assign({},appModel.preferences)}};var documentReady=function(){return new Promise((function(resolve,reject){if(globalContext.document.readyState==="loading"){globalContext.document.addEventListener("DOMContentLoaded",(function(){resolve()}))}else{resolve()}}))};var createMessage=function(errorPrefix,message){return errorPrefix+": Invalid page model: "+message};var throwIfAlreadyTriggered=function(isRenderTriggered){if(isRenderTriggered){throw createError("The renderItem() method must to be called only once. "+"But actually this method has been called by Mobile SDK more than 1 time. "+"Likely there is an issue in native code.")}};var throwIfInvalidMBAASPage=function(errorPrefix,mbaasPageModel){if(!isObject(mbaasPageModel)){throw createTypeError(createMessage(errorPrefix,"No page model was provided"))}if(!isArray(mbaasPageModel.children)){throw createTypeError(createMessage(errorPrefix,"The page model does not have children"))}if(!mbaasPageModel.id){throw createTypeError(createMessage(errorPrefix,"The page model does not have a specified id"))}if(!mbaasPageModel.name){throw createTypeError(createMessage(errorPrefix,"The page model does not have a specified name"))}if(!isObject(mbaasPageModel.preferences)){throw createTypeError(createMessage(errorPrefix,"The page model does not have preferences"))}};var throwIfInvalidWA3Application=function(errorPrefix){if(!isObject(globalContext.BB)){throw createError(errorPrefix+': Namespace "window.BB" is not available')}if(!isFunction(globalContext.BB.startSingleApp)){throw createError(errorPrefix+': "window.BB.startSingleApp" is not a function')}};var createRenderer=function(applicationConfig){var name="hsdk-renderer-wa3";var isRenderTriggered=false;var renderItem=function(mbaasModel){return documentReady().then((function(){var errorPrefix="Unable to start the application";var mbaasPageModel=isPortalModel(mbaasModel)?getPageModel(mbaasModel):mbaasModel;throwIfInvalidMBAASPage(errorPrefix,mbaasPageModel);throwIfInvalidWA3Application(errorPrefix);throwIfAlreadyTriggered(isRenderTriggered);isRenderTriggered=true;var wa3AppModel=toWA3AppModel(mbaasPageModel);return getBBNamespace().startSingleApp().then((function(wa3Application){return wa3Application.bootstrap(wa3AppModel)}))}))};return{name:name,renderItem:renderItem}};var setRenderer=function(){if(!isObject(getHSDKCore())){throw createError("Unable to set the renderer: HSDK Core is not available on the window")}getHSDKCore().setRenderer(createRenderer)};setRenderer()})();
